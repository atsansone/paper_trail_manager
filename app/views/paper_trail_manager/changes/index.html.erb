<h1>Changes</h1>

<p class='changes_feed'><%= link_to 'Changes feed', changes_path(:format => 'atom') %></p>

<p>
  Show:
<div class="btn-group">
  <button type="button" class="btn btn-default">
  <%= ([link_to('All', changes_path)] + change_item_types.map { |type| link_to(type.pluralize, changes_path(:type => type)) }).join('</button><button type="button" class="btn btn-default">').html_safe %>
  </button>
<div>
</p>

<table class='changes_table table table-striped table-hover table-condensed'>
  <tfoot>
    <tr>
      <td colspan='2'>
        <%= paginate @versions %>
      </td>
    </tr>
  </tfoot>
  <thead>
    <tr class='changes_header'>
      <th class='change_number'>Change</th>
      <th class='change_time'>Time</th>
      <th class='change_details'>Action</th>
      <th class='change_details'>Table</th>
      <th class='change_details'>Record</th>
      <th class='change_details'>Object</th>
      <% if PaperTrailManager.whodunnit_class && version.whodunnit %>
        <th class='change_details'>
          Changed by
        </th>
      <% end %>
      <th class='change_details'>Attribute with previous and current values</th>
      <th class='change_details'>Change</th>
    </tr>
  </thead>
  <tbody>
    <% if @versions.any? %>
      <% @versions.each do |version| %>
        <% next unless change_show_allowed?(version) %>
        <%= render :partial => 'version', :object => version %>
      <% end %>
    <% else %>
      <td rowspan='2'> &mdash; No changes found &mdash; </td>
    <% end %>
  </tbody>
</table>